"""Детальные промпты для нумерологических отчётов."""


def get_system_prompt(style: str) -> str:
    """
    Получить системный промпт в зависимости от стиля.

    Args:
        style: Стиль отчёта (analytical/shamanic)

    Returns:
        str: Системный промпт
    """
    if style == "analytical":
        return """Ты профессиональный нумеролог с многолетним опытом и научным подходом к анализу.
Твоя задача - создавать детальные, структурированные отчёты на основе методов классической нумерологии.
Используй аналитический, научный стиль изложения с четкой структурой и обоснованными выводами.
Опирайся на методы Пифагора, Генокод и другие проверенные нумерологические системы."""

    elif style == "shamanic":
        return """Ты мудрый нумеролог-шаман с глубоким пониманием эзотерических практик и древних знаний.
Твоя задача - создавать вдохновляющие, образные отчёты, раскрывающие духовную суть человека.
Используй шаманский, эзотерический стиль с метафорами, символами и глубокими инсайтами.
Опирайся на древние традиции, сакральную геометрию и духовные практики."""

    return "Ты профессиональный нумеролог с многолетним опытом."


def build_detailed_prompt(tariff: str, style: str, participants: list) -> str:
    """
    Построение детального промпта для нумерологического анализа.

    Args:
        tariff: Тип тарифа (quick/deep/pair/family)
        style: Стиль отчёта (analytical/shamanic)
        participants: Список участников с данными

    Returns:
        str: Детальный промпт для AI
    """
    # Базовая информация об участниках
    participants_info = ""
    for idx, p in enumerate(participants, 1):
        participants_info += f"\n{idx}. {p['full_name']}"
        participants_info += f"\n   Дата рождения: {p['birth_date']}"
        if p.get('birth_time'):
            participants_info += f"\n   Время рождения: {p['birth_time']}"
        if p.get('birth_place'):
            participants_info += f"\n   Место рождения: {p['birth_place']}"
        participants_info += "\n"

    # Промпты для разных тарифов
    if tariff == "quick":
        return _build_quick_prompt(style, participants_info)
    elif tariff == "deep":
        return _build_deep_prompt(style, participants_info)
    elif tariff == "pair":
        return _build_pair_prompt(style, participants_info)
    elif tariff == "family":
        return _build_family_prompt(style, participants_info)

    return _build_quick_prompt(style, participants_info)


def _build_quick_prompt(style: str, participants_info: str) -> str:
    """Краткий анализ (5-7 страниц)."""
    style_note = ""
    if style == "analytical":
        style_note = "Используй научный, структурированный подход с четкими выводами."
    elif style == "shamanic":
        style_note = "Используй образный, эзотерический язык с духовными инсайтами."

    return f"""Создай краткий нумерологический отчёт на 5-7 страниц для следующего человека:

{participants_info}

{style_note}

СТРУКТУРА ОТЧЁТА:

1. ВВЕДЕНИЕ (0.5 страницы)
   - Приветствие и краткое введение в нумерологию
   - Что ждёт клиента в отчёте

2. ЧИСЛО ЖИЗНЕННОГО ПУТИ (1.5 страницы)
   - Расчёт числа жизненного пути
   - Основное значение и характеристики
   - Жизненные задачи и предназначение

3. ЧИСЛА ИМЕНИ (1 страница)
   - Число выражения (полное имя)
   - Число души (гласные)
   - Число личности (согласные)

4. ГОДОВОЙ ПРОГНОЗ (1 страница)
   - Персональный год на текущий период
   - Ключевые тенденции и возможности

5. ТАЛАНТЫ И СПОСОБНОСТИ (1 страница)
   - Сильные стороны личности
   - Скрытые таланты
   - Области для развития

6. ПРАКТИЧЕСКИЕ РЕКОМЕНДАЦИИ (1 страница)
   - Конкретные советы для реализации потенциала
   - Благоприятные направления деятельности
   - Советы по личному развитию

ТРЕБОВАНИЯ:
- Объём: 5-7 страниц (около 2500-3500 слов)
- Структурированный, понятный язык
- Конкретные примеры и рекомендации
- Позитивный, мотивирующий тон"""


def _build_deep_prompt(style: str, participants_info: str) -> str:
    """Глубокий анализ с Генокодом (15-20 страниц)."""
    style_note = ""
    if style == "analytical":
        style_note = "Используй научный подход с детальным анализом и обоснованными выводами."
    elif style == "shamanic":
        style_note = "Используй шаманский подход с глубокими духовными инсайтами и образным языком."

    return f"""Создай глубокий нумерологический отчёт на 15-20 страниц с использованием Генокода и метода Пифагора:

{participants_info}

{style_note}

СТРУКТУРА ОТЧЁТА:

1. ВВЕДЕНИЕ (1 страница)
   - Приветствие и философия нумерологии
   - Методы анализа (Пифагор, Генокод)
   - Структура отчёта

2. БАЗОВЫЙ НУМЕРОЛОГИЧЕСКИЙ ПРОФИЛЬ (3 страницы)
   - Число Жизненного Пути (детальный анализ)
   - Число Выражения (полное имя)
   - Число Души (желания и мотивация)
   - Число Личности (внешнее проявление)
   - Число Зрелости (после 30-35 лет)
   - Кармические числа и долги

3. КВАДРАТ ПИФАГОРА (3 страницы)
   - Построение психоматрицы из даты рождения
   - Анализ всех 9 секторов:
     * Характер и целеустремлённость (1)
     * Энергия и жизненная сила (2)
     * Познание и творчество (3)
     * Здоровье и красота (4)
     * Логика и интуиция (5)
     * Труд и мастерство (6)
     * Удача и везение (7)
     * Долг и ответственность (8)
     * Память и ясновидение (9)
   - Анализ строк, столбцов и диагоналей
   - Сильные и слабые стороны

4. ГЕНОКОД ЛИЧНОСТИ (4 страницы)
   - Построение матрицы судьбы (22 аркана)
   - Анализ ключевых точек:
     * Личный аркан (кто я есть)
     * Социальный аркан (моя роль в обществе)
     * Духовный аркан (моё предназначение)
     * Родовые программы (линия отца и матери)
     * Кармические задачи
   - Энергетические центры (чакры) и их проработка
   - Программы процветания и здоровья

5. ЖИЗНЕННЫЕ ЦИКЛЫ И ПЕРИОДЫ (2 страницы)
   - Пиннаклы (вершины) и Челленджи (испытания)
   - Периоды жизни (молодость, зрелость, мудрость)
   - Персональные годы (прогноз на ближайшие 3 года)
   - Ключевые точки трансформации

6. ТАЛАНТЫ, СПОСОБНОСТИ И ПРИЗВАНИЕ (2 страницы)
   - Врождённые таланты и дары
   - Профессиональное предназначение
   - Финансовые возможности и денежные потоки
   - Творческий потенциал

7. ОТНОШЕНИЯ И СОВМЕСТИМОСТЬ (1.5 страницы)
   - Подходящие числа для партнёрства
   - Уроки в отношениях
   - Рекомендации для гармонии

8. ЗДОРОВЬЕ И ЭНЕРГЕТИКА (1 страница)
   - Зоны внимания по дате рождения
   - Энергетические практики
   - Благоприятные периоды для укрепления здоровья

9. ПРАКТИЧЕСКИЕ РЕКОМЕНДАЦИИ (1.5 страницы)
   - Конкретные шаги для реализации потенциала
   - Медитации и аффирмации
   - Благоприятные числа, цвета, камни
   - Направления развития

ТРЕБОВАНИЯ:
- Объём: 15-20 страниц (около 7500-10000 слов)
- Глубокий, детальный анализ каждого аспекта
- Использование методов Пифагора и Генокода
- Конкретные расчёты и обоснования
- Практические примеры и рекомендации"""


def _build_pair_prompt(style: str, participants_info: str) -> str:
    """Анализ совместимости пары (15-25 страниц)."""
    style_note = ""
    if style == "analytical":
        style_note = "Используй структурированный подход с детальным анализом совместимости."
    elif style == "shamanic":
        style_note = "Используй эзотерический подход, раскрывая духовную связь партнёров."

    return f"""Создай детальный анализ совместимости пары на 15-25 страниц:

{participants_info}

{style_note}

СТРУКТУРА ОТЧЁТА:

1. ВВЕДЕНИЕ (1 страница)
   - Приветствие пары
   - Философия нумерологической совместимости
   - Что ждёт в отчёте

2. ИНДИВИДУАЛЬНЫЕ ПРОФИЛИ (4 страницы - по 2 на каждого)

   ПАРТНЁР 1:
   - Число Жизненного Пути
   - Число Души и Выражения
   - Квадрат Пифагора (краткий)
   - Основные характеристики личности

   ПАРТНЁР 2:
   - Число Жизненного Пути
   - Число Души и Выражения
   - Квадрат Пифагора (краткий)
   - Основные характеристики личности

3. АНАЛИЗ СОВМЕСТИМОСТИ (6 страниц)

   3.1 Совместимость Чисел Жизненного Пути (1.5 страницы)
   - Базовая совместимость (расчёт и процент)
   - Гармония или конфликт путей
   - Как дополняют друг друга

   3.2 Совместимость Душ (1.5 страницы)
   - Эмоциональная связь
   - Общие ценности и мотивации
   - Духовная близость

   3.3 Матрица Отношений (2 страницы)
   - Число отношений (сумма чисел пути)
   - Кармическая связь (есть ли кармический долг)
   - Родовые программы и их влияние
   - Общие уроки и задачи пары

   3.4 Динамика Энергий (1 страница)
   - Баланс мужской и женской энергии
   - Активный и пассивный партнёр
   - Энергообмен в паре

4. СИЛЬНЫЕ СТОРОНЫ ОТНОШЕНИЙ (2 страницы)
   - Что объединяет пару
   - Области гармонии и взаимопонимания
   - Совместные таланты и возможности
   - Потенциал для роста вместе

5. ЗОНЫ РОСТА И ИСПЫТАНИЯ (3 страницы)
   - Потенциальные конфликты и их причины
   - Различия в характерах и подходах
   - Кармические уроки для пары
   - Как проявляются испытания
   - Способы преодоления трудностей

6. ФИНАНСЫ И МАТЕРИАЛЬНАЯ СФЕРА (1.5 страницы)
   - Совместимость в денежных вопросах
   - Совместный финансовый потенциал
   - Подходы к заработку и тратам
   - Рекомендации по финансовой гармонии

7. ИНТИМНАЯ И ЭМОЦИОНАЛЬНАЯ СФЕРА (2 страницы)
   - Эмоциональная совместимость
   - Интимная гармония
   - Язык любви каждого партнёра
   - Как укрепить близость

8. СЕМЬЯ И ДЕТИ (1.5 страницы)
   - Родительский потенциал пары
   - Подходы к воспитанию детей
   - Семейные ценности и традиции
   - Благоприятные годы для рождения детей

9. ПРОГНОЗ НА БЛИЖАЙШИЕ ГОДЫ (2 страницы)
   - Персональные годы каждого партнёра
   - Совместные периоды и циклы
   - Благоприятные периоды для важных решений
   - Периоды испытаний и как их пройти

10. ПРАКТИЧЕСКИЕ РЕКОМЕНДАЦИИ (2 страницы)
    - Конкретные советы для гармонии
    - Как использовать сильные стороны
    - Работа с зонами роста
    - Совместные практики и ритуалы
    - Благоприятные дни, числа, цвета для пары

ТРЕБОВАНИЯ:
- Объём: 15-25 страниц (около 7500-12500 слов)
- Баланс позитивного и реалистичного взгляда
- Конкретные примеры и ситуации
- Уважительный тон к обоим партнёрам
- Практические инструменты для развития отношений"""


def _build_family_prompt(style: str, participants_info: str) -> str:
    """Семейный анализ (30-50 страниц)."""
    style_note = ""
    if style == "analytical":
        style_note = "Используй системный подход с анализом семейной динамики и взаимодействий."
    elif style == "shamanic":
        style_note = "Используй целостный подход, раскрывая родовые связи и духовное единство семьи."

    return f"""Создай комплексный семейный нумерологический отчёт на 30-50 страниц:

{participants_info}

{style_note}

СТРУКТУРА ОТЧЁТА:

1. ВВЕДЕНИЕ (2 страницы)
   - Приветствие семьи
   - Философия семейной нумерологии
   - Как использовать отчёт
   - Структура анализа

2. ИНДИВИДУАЛЬНЫЕ ПРОФИЛИ ЧЛЕНОВ СЕМЬИ (по 3-4 страницы на человека)

   Для каждого члена семьи:
   - Число Жизненного Пути и его значение
   - Число Души и Выражения
   - Квадрат Пифагора (основные показатели)
   - Ключевые черты характера
   - Таланты и способности
   - Жизненные задачи
   - Роль в семейной системе

3. СЕМЕЙНАЯ МАТРИЦА (5 страниц)
   - Общее число семьи (сумма всех чисел пути)
   - Характеристика семейной энергии
   - Кармические связи в семье
   - Родовые программы:
     * Линия отца (3 поколения)
     * Линия матери (3 поколения)
     * Наследственные паттерны
     * Родовые таланты и ресурсы
     * Родовые задачи и долги

4. СЕМЕЙНАЯ ДИНАМИКА И ВЗАИМОДЕЙСТВИЯ (6 страниц)
   - Анализ отношений между всеми членами семьи
   - Совместимость родителей (краткий анализ пары)
   - Отношения родители-дети (каждая связка):
     * Особенности взаимодействия
     * Зоны понимания и конфликтов
     * Как найти общий язык
   - Отношения между детьми (если есть):
     * Динамика братьев/сестёр
     * Совместимость и различия
     * Рекомендации по гармонизации
   - Энергетический баланс в семье

5. РОЛИ В СЕМЬЕ (3 страницы)
   - Лидер и организатор
   - Эмоциональный центр
   - Миротворец
   - Вдохновитель
   - Практик
   - Как роли дополняют друг друга
   - Конфликты ролей и их решение

6. СЕМЕЙНЫЕ ЦЕННОСТИ И МИССИЯ (2 страницы)
   - Общие ценности семьи
   - Семейная миссия и предназначение
   - Чему семья учит каждого члена
   - Вклад семьи в мир

7. ФИНАНСЫ И МАТЕРИАЛЬНОЕ БЛАГОПОЛУЧИЕ (3 страницы)
   - Финансовый потенциал семьи
   - Подходы к деньгам у разных членов
   - Совместные финансовые возможности
   - Кто и как зарабатывает
   - Как гармонизировать денежные потоки
   - Благоприятные периоды для финансовых решений

8. ДЕТИ: ВОСПИТАНИЕ И РАЗВИТИЕ (4 страницы)

   Для каждого ребёнка:
   - Особенности характера и темперамента
   - Таланты и способности
   - Подходящие методы воспитания
   - Как поддержать развитие
   - Потенциальные трудности
   - Отношения со сверстниками
   - Профориентация (если подросток)
   - Благоприятные направления обучения

9. СЕМЕЙНОЕ ЗДОРОВЬЕ (2 страницы)
   - Зоны внимания для каждого члена семьи
   - Общие рекомендации по здоровью
   - Энергетические практики для семьи
   - Благоприятный образ жизни

10. ЖИЗНЕННЫЕ ЦИКЛЫ СЕМЬИ (3 страницы)
    - Персональные годы каждого члена
    - Совместные семейные циклы
    - Ближайшие 3-5 лет: прогноз
    - Благоприятные периоды для:
      * Переездов
      * Крупных покупок
      * Смены работы/школы
      * Важных решений
    - Периоды испытаний и роста

11. СЕМЕЙНЫЕ ТРАДИЦИИ И РИТУАЛЫ (2 страницы)
    - Благоприятные семейные ритуалы
    - Дни для семейных событий
    - Места силы для семьи
    - Символы и амулеты семьи

12. ПРАКТИЧЕСКИЕ РЕКОМЕНДАЦИИ (3 страницы)
    - Конкретные советы для гармонии
    - Как использовать сильные стороны семьи
    - Работа с зонами роста
    - Совместные практики:
      * Семейные медитации
      * Игры и активности
      * Традиции
    - Индивидуальные рекомендации каждому
    - Как поддержать друг друга

13. ЗАКЛЮЧЕНИЕ (1 страница)
    - Резюме ключевых инсайтов
    - Напутствие семье
    - Главные рекомендации

ТРЕБОВАНИЯ:
- Объём: 30-50 страниц (около 15000-25000 слов)
- Глубокий, всесторонний анализ
- Баланс индивидуального и системного подхода
- Уважительный тон ко всем членам семьи
- Конкретные примеры и рекомендации
- Учёт возрастных особенностей
- Позитивный, поддерживающий настрой"""
